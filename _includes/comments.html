<div class="divider"></div>

<h2 style="text-align: left; margin-bottom: 0;">댓글</h2>

<div id="comments-wrapper"></div>

<script>
  const themeMap = {
    dark: "dark-blue",
    light: "github-light",
  };

  function loadUtterances(theme) {
    console.log(`reloading utterances with theme: ${theme}`);
    const wrapper = document.getElementById("comments-wrapper");
    wrapper.innerHTML = "";

    const script = document.createElement("script");
    script.src = "https://utteranc.es/client.js";
    script.setAttribute("repo", "potados99/potados99.github.io");
    script.setAttribute("issue-term", "title");
    script.setAttribute("label", "comment");
    script.setAttribute("theme", theme);
    script.setAttribute("crossorigin", "anonymous");
    script.async = true;

    wrapper.appendChild(script);
  };

  document.addEventListener("DOMContentLoaded", () => {
    loadUtterances(themeMap[loadCalculatedTheme()]);

    whenToggleClicked(() => {
      loadUtterances(themeMap[loadCalculatedTheme()]);
    });

    whenSystemThemeChanged((theme) => {
      if (!userHasSetThemePreference()) {
        loadUtterances(themeMap[theme]);
      }
    });
  });
</script>